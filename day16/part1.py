# Replaced '\' with '7' for ease of string/char use

inputRaw = """7.............7................7....7..../....7/...............................7...-..........-.7.-....../....
|7......../|....7..............-7............./...........................-..........-......7........7........
.......||......../....-./.../-...|.|..-......-.|....../................7............|...................-..|..
........./......-.............-7......................|.7./.......|........./......-......../..-.........|....
....../....................-............................................../...../...|.........................
....................7....|/............................./.......-....|......../..........................7....
.|....../|.........-......|.............7..|..................|......../.................|.|............-.|...
.....-............77............7................/......-.........7................7..|../....................
............|..|.......|......../................7.......................|../....../......./.....|............
.7...........7..7.............../.........-/....|......................./.....-./-.........../-........-......
|................7.7-.............../..-............./........./.................7.............|...-.....-....
.........-....|..|......................................7.||...-../..|............../...../.../.........-.....
.....-....-7.................|...........|../.....7...............................|...../../|.................
.7......7......................7....../.../.....-.../.........................../..|...........|..7...........
-............|.........-.-........-.........................|...7...-...........7.|...-....../..........|.....
.........-.......|......7.....7..-...../..../.....7.../............/..........-......./....../...........7.../
..............7........................|.............................-../......-..-...../..................7..
.....7......-.......-.......-......../../../........7.......-..........|......./........................../...
.7...7...................|./7|.-..7...............................7..7.....-....|......................./.....
.................-...|....|.../...../.|.||.....-.|............................-..............7................
........................................../.......................|........7......../.../..............|.....7
.......7......./............................./........../../..........................-7..................|...
...........-...|..7..........-.........7.................././................|./.......|............../.......
......./..................................7...-.........7........7....../............................7......7-
-.|..-|...............|..........................7..........|.-.........7............-.|.............7.....|..
.............................../..............-.....-.......-........................|.......-................
.........7.........-.........|...../......../......./....-...7...................7........7...................
..........7.........7........../...|.................|./...7.......7..........-...............................
./...................|........../7......../....................|..-...........7...7...........|..............|
.....|...........7-.7.......-..........................-....-...................|....|.|...............-......
.|.././......................|.......|.......|..............7...../.................../.7...-.................
...........-........./....|.................|..-.....-............./...................................-..../.
...................7/..|.....-............../-......-..........|........................./...7....-|....|-....
........................./..-..|.7-...............-......-/...../.......7..|................-...7.|.....7.....
7...../.........................../....................-..........|........../..-..-.......7........../.././|.
........................../...7|..................................................../...|.-........-.....|..7.
....7.............................|./.....|...../....7.............7...../.......-...............7..-..../....
.........-.........................|................|........7/.7-...................7..-......./../..........
...-.../............/.................-..........7....../............../...../..........|.....................
..........7...7..................|...-......77......./...-.............-7.................|...../......7......
/..7/.............7....7.............7.......................................|.....7....-............7........
....../..7.|................................7.........../.......-.......-/.....|...................-.....-....
........-....|.............................|....../...............7.......................--..................
................/......|.........-....................-..............|.......................................|
.........7........|...........................7.............|.............................../.................
...|..7....-......../.7...-............................................................/....-...../...........
.............777.../...../.../..........7..............7...........7........................|....../.........7
......-..............|..-..|....-7..7..-...-............7.................7...-.7/.....7......-.7....--.../...
........./...................../...../..|...7.7/.........7.../........................................7.../-..
........7.......|.......|7..|........../..../7........../........7..../..............././..../.............-.7
........................|-............|............................./.-.|...|............../....-7............
../........-.../....................|....................-/.............../.....-...........-....7......||....
.....7..|.....-|../....|./....-|.......-...../..-..7..............7...................../.................|...
...-......../.7...........7.........7../.....|............7..................../.........7................/.7/
...../...|............-..7.../............/............-..............--.-..........././............-........|
.....|...........7.....-...7..../.....-........-.....7.|..............7....-............./...../..............
....7.....-.|....7..../..............7|../.........../......|....7/.......................|............|....-.
........|..--..............|..............-........|.......|.-.........7.............-...........7............
./.||....7......./....7./........../...........././....7.................../..................7...../.........
.......|..7...-.7..7..|.........../..................................-....|........7......|....|..............
...|..........|.........-...............|...............................-.......|...........-..7.......7......
.7.........../../............................-..|...7.....-.........../......-|.../.....|.................-...
........|....../..7..7|..|......|.........|...............................7../.....7....-/........-...........
.................................................7.......|........|.7.-....../.......|.......|............7...
.......|.......7.......|.........|......-......|...|...7.............7.............|/.........................
..........|....................|..........7..........-......./................................................
...../.......|....................|......................././.................................................
........7.............|........--..........7.............../......|...................../............|..7.....
....-............|.........|....|.-.7../-...7....-...-................7|..7-.......|........-............../..
................/........7.....7.....././....|....................-...............7...........-......7........
.7.....|......|...|7......7.7/....7.............-............7.....7.......-...-........-....//..../.....|..-.
..................|..|.-.................../7...........|..../..........7|.....-..|.../.......................
-......-......./........./../.............../..................-..7.......7............|...../../....../......
....../............/...........7.............7............./.........../.......7......|....|.........../......
...7........|..................|............-............-.....-..7..-................/........../........||..
......../..|..-../..../......................../.........7./.-................../...................-.........
.../....|....7.......-..7..........-....7.............|7........../...............-........|..................
..............7.............7|.........-......................-........7|......./.......-.................|...
/..../...-||7-...|7...............................7.......................7.............-................-....
.......-..-....|..................|..............................................................///...-.../.|
......|.......-/........-.-......|....7..-...|...........7...........7.....................-..../.........../.
......-...........|-..7.......|...|.7|.................-....7...................7.7........7.7./.........7....
....../............../.........|...|.......|..../.............................................................
.........../...................-./...7..........7-............./...........7.../.....|......................-.
/..../..../........................................|.7......-/......./....7.........................-......|..
.7./.|.-..........................|...|...........|....../....-....../|...............7..............7...-....
....|...7..........|......-..................|........../..|.-...7........./........|................|........
...7....7........../........../.........7..............-...........................-.|...../..........7.......
...|...........-...........................7........-.........................7...-..-.....7.......|........-.
......7|...........................7.....................................-............/....7...........|......
................../............-........................7.................................................-...
.../....|...............|....................../7.........|....................7....|............7.........|-.
.......................................|....-.........../....7-........|......./............-..|.............7
/.........7..7.........|...............7.......7........./................7....................|.....|........
..................................|.....|.-..|.../......................../-7......|..........................
.................|.....................................................-............|.....|..../.7/..........|
.......7....7....-........|.|..../......-......7...../....................-...........7............-..........
....-.................................-..........-......-................................../.........-7...|...
.....................|......................|.........-............../.../.....-........7.....................
.7./..........-.7...7||................./../........7.........|...7........7....7.7...............-|......|...
..7......//.........../.7........7......|......|........7......7.....-..........|.-..|...../|.................
/.....................7.................-........|...................7.....-..............-/.....7..|../../...
...|..-.../............./.|.................../............/..7...........-....|-............7.......--.......
..............7..7/.....7.........|.7.........................|............|........./................./-..|-.
...........................-.................../...................|7..........7/..|.-........................
.....-.............................../....................7.........|......................|..................
..................7.........../...........7..7/.........|...........|..-........|....7..........-...../.|.....
..........|.......7..7...........7.../......................-...........-.....-........../7|..................
....../.......-........................7|...//...7..-......7.......|..7....................-..........7..-....
|./....|........-./........../.7...7.....|../..../.......-........../.7.....-.................................
"""

testInputRaw = """.|...7....
|.-.7.....
.....|-...
........|.
..........
.........7
..../.77..
.-.-/..|..
.|....-|.7
..//.|...."""

#layoutGrid = testInputRaw.splitlines()
layoutGrid = inputRaw.splitlines()

alreadyTraveledGrid = []
for row in range(len(layoutGrid)):
    alreadyTraveledGrid.append([])
    for col in range(len(layoutGrid[0])):
        alreadyTraveledGrid[row].append([])

def traceBeam(rowIdx, colIdx, curDirection):
    while (rowIdx >= 0 and rowIdx < len(layoutGrid)) and \
    (colIdx >= 0 and colIdx < len(layoutGrid[0])):
        if curDirection in alreadyTraveledGrid[rowIdx][colIdx]:
            return
        alreadyTraveledGrid[rowIdx][colIdx].append(curDirection)

        curChar = layoutGrid[rowIdx][colIdx]
        if curChar == '.':
            if curDirection == 'N':
                rowIdx -= 1
            if curDirection == 'S':
                rowIdx += 1
            if curDirection == 'W':
                colIdx -= 1
            if curDirection == 'E':
                colIdx += 1
        if curChar == '-':
            if curDirection == 'W':
                colIdx -= 1
            elif curDirection == 'E':
                colIdx += 1
            else:
                traceBeam(rowIdx, colIdx-1, 'W')
                traceBeam(rowIdx, colIdx+1, 'E')
                return
        if curChar == '|':
            if curDirection == 'N':
                rowIdx -= 1
            elif curDirection == 'S':
                rowIdx += 1
            else:
                traceBeam(rowIdx-1, colIdx, 'N')
                traceBeam(rowIdx+1, colIdx, 'S')
                return
        if curChar == '/':
            if curDirection == 'N':
                curDirection = 'E'
                colIdx += 1
            elif curDirection == 'S':
                curDirection = 'W'
                colIdx -= 1
            elif curDirection == 'W':
                curDirection = 'S'
                rowIdx += 1
            elif curDirection == 'E':
                curDirection = 'N'
                rowIdx -= 1
        if curChar == '7':
            if curDirection == 'N':
                curDirection = 'W'
                colIdx -= 1
            elif curDirection == 'S':
                curDirection = 'E'
                colIdx += 1
            elif curDirection == 'W':
                curDirection = 'N'
                rowIdx -= 1
            elif curDirection == 'E':
                curDirection = 'S'
                rowIdx += 1
    return


traceBeam(0, 0, 'E')

tileCount = 0
for row in alreadyTraveledGrid:
    for charList in row:
        if charList:
            tileCount += 1
print(tileCount)

